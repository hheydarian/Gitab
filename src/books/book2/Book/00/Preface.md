# پیشگفتار

به "کد تمیز در سی‌شارپ" خوش آمدید. در این کتاب یاد می‌گیرید که چگونه کدهای مشکل‌ساز را شناسایی کنید؛ کدهایی که با وجود کامپایل شدن، قابلیت **خوانایی (readability)**، **نگهداری (maintainability)** و **توسعه‌پذیری (extensibility)** مناسبی ندارند. همچنین با ابزارها و الگوهای مختلفی آشنا می‌شوید، همراه با روش‌هایی برای **Refactor** کردن کد به منظور پاکیزه ساختن آن.

## این کتاب برای چه کسانی است؟

این کتاب برای برنامه‌نویسان کامپیوتر با درک خوبی از زبان برنامه‌نویسی C# نگاشته شده است که به دنبال راهنمایی برای شناسایی کدهای مشکل‌ساز و **نوشتن کد تمیز (clean code)** در C# هستند. در درجه اول، مخاطبان این کتاب از برنامه‌نویسان **تازه‌کار (Graduate)** تا **سطح میانی (Mid-level)** را شامل می‌شوند، اما حتی **برنامه‌نویسان ارشد (Senior)** نیز ممکن است این کتاب را ارزشمند بیابند.

## این کتاب چه مباحثی را پوشش می‌دهد؟

**فصل ۱، استانداردهای کدنویسی و اصول در سی‌شارپ (Coding Standards and Principles in C#)**، به مقایسه کدهای خوب با کدهای بد می‌پردازد. با مطالعه این فصل، درک خواهید کرد که چرا به استانداردهای کدنویسی، اصول، متدولوژی‌ها و قراردادهای کد نیاز دارید. در مورد **ماژولار بودن (Modularity)** و دستورالعمل‌های طراحی **KISS**، **YAGNI**، **DRY**، **SOLID** و **تیغ اوکام (Occam's razor)** می‌آموزید.

**فصل ۲، بازبینی کد - فرآیند و اهمیت (Code Review – Process and Importance)**، شما را با فرآیند بازبینی کد آشنا کرده و دلایل اهمیت آن را ارائه می‌دهد. در این فصل، در مورد فرآیند آماده‌سازی کد برای بازبینی، رهبری یک جلسه بازبینی کد، دانستن اینکه چه چیزی را بازبینی کنید، زمان مناسب برای ارسال کد برای بازبینی، و نحوه ارائه و پاسخ به بازخورد بازبینی، راهنمایی می‌شوید.

**فصل ۳، کلاس‌ها، اشیاء و ساختارهای داده (Classes, Objects, and Data Structures)**، به موضوعات گسترده‌ای مانند سازماندهی کلاس‌ها، **کامنت‌های مستندسازی (Documentation Comments)**، **پیوستگی (Cohesion)**، **وابستگی (Coupling)**، **قانون دیمیتر (Law of Demeter)**، و **اشیاء و ساختارهای داده تغییرناپذیر (Immutable Objects and Data Structures)** می‌پردازد. در پایان این فصل، قادر خواهید بود کدهایی بنویسید که به خوبی سازماندهی شده و تنها یک مسئولیت دارند، مستندات مرتبط را برای کاربران کد فراهم کنید و کد را توسعه‌پذیر سازید.

**فصل ۴، نوشتن توابع تمیز (Writing Clean Functions)**، به شما کمک می‌کند تا **برنامه‌نویسی تابعی (Functional Programming)** را درک کنید، نحوه کوچک نگه داشتن متدها، و چگونگی اجتناب از تکرار کد و پارامترهای متعدد را بیاموزید. در زمان اتمام این فصل، قادر خواهید بود برنامه‌نویسی تابعی را توصیف کنید، کد تابعی بنویسید، از نوشتن کد با بیش از دو پارامتر اجتناب کنید، اشیاء و ساختارهای داده تغییرناپذیر بنویسید، متدهای خود را کوچک نگه دارید، و کدی بنویسید که به **اصل تک‌مسئولیتی (Single Responsibility Principle)** پایبند باشد.

**فصل ۵، مدیریت استثنا (Exception Handling)**، به استثناهای **کنترل‌شده (checked)** و **کنترل‌نشده (unchecked)**، **NullPointerException** و نحوه اجتناب از آن‌ها می‌پردازد. همچنین استثناهای مربوط به قوانین کسب‌وکار، ارائه داده‌های معنادار، و ساخت استثناهای سفارشی خودتان را پوشش می‌دهد.

**فصل ۶، تست واحد (Unit Testing)**، شما را از طریق متدولوژی توسعه نرم‌افزار **توسعه رفتار محور (Behavior-Driven Development - BDD)** با استفاده از **SpecFlow**، و **توسعه تست محور (Test-Driven Development - TDD)** با استفاده از **MSTest** و **NUnit** راهنمایی می‌کند. می‌آموزید که چگونه اشیاء **Mock** (جعلی) را با استفاده از **Moq** بنویسید، و چگونه از متدولوژی نرم‌افزاری TDD برای نوشتن تست‌هایی که شکست می‌خورند، گذراندن تست‌ها، و سپس **Refactor** کردن کد پس از گذراندن تست‌ها استفاده کنید.

**فصل ۷، تست سیستم End-to-End (End-to-End System Testing)**، شما را از طریق فرآیند دستی تست End-to-End با استفاده از یک پروژه نمونه راهنمایی می‌کند. در این فصل، تست **End-to-End (E2E)**، **کارخانه‌های کد و تست (Code and Test Factories)**، **تزریق وابستگی کد و تست (Code and Test Dependency Injection)**، و **ماژولار کردن تست (Test Modularization)** را انجام خواهید داد. همچنین یاد می‌گیرید که چگونه از ماژولار بودن بهره‌برداری کنید.

**فصل ۸، Threading و Concurrency (همزمانی)**، بر درک چرخه حیات Thread تمرکز دارد؛ اضافه کردن پارامترها به Threadها؛ استفاده از **ThreadPool**، **Mutex**ها و Threadهای همزمان؛ کار با Threadهای موازی با استفاده از **Semaphore**ها؛ محدود کردن تعداد Threadها و پردازنده‌های مورد استفاده توسط ThreadPool؛ جلوگیری از **Deadlock**ها و **Race Condition**ها؛ متدهای استاتیک و سازنده‌ها؛ **تغییرپذیری و تغییرناپذیری (Mutability and Immutability)**؛ و **Thread-Safety**.

**فصل ۹، طراحی و توسعه APIها (Designing and Developing APIs)**، به شما کمک می‌کند تا مفهوم API چیست، **پراکسی‌های API (API Proxies)**، دستورالعمل‌های طراحی API، طراحی API با استفاده از **RAML** و توسعه API با **Swagger** را درک کنید. در این فصل، شما یک API مستقل از زبان را در RAML طراحی کرده و آن را در C# توسعه خواهید داد، و API خود را با استفاده از Swagger مستندسازی خواهید کرد.

**فصل ۱۰، ایمن‌سازی APIها با کلیدهای API و Azure Key Vault (Securing APIs with API Keys and Azure Key Vault)**، به شما نشان می‌دهد که چگونه یک کلید API شخص ثالث را به دست آورید، آن کلید را در Azure Key Vault ذخیره کنید، و آن را از طریق API که خواهید ساخت و در Azure مستقر خواهید کرد، بازیابی کنید. سپس **احراز هویت (Authentication)** و **مجوزدهی (Authorization)** کلید API را برای ایمن‌سازی API خود پیاده‌سازی خواهید کرد.

**فصل ۱۱، پرداختن به نگرانی‌های بین‌بخشی (Addressing Cross-Cutting Concerns)**، شما را با استفاده از **PostSharp** برای پرداختن به نگرانی‌های بین‌بخشی با استفاده از **Aspect**ها و **Attribute**هایی که اساس **توسعه Aspect-Oriented** را تشکیل می‌دهند، آشنا می‌کند. همچنین یاد می‌گیرید که چگونه از پراکسی‌ها و **Decorator**ها استفاده کنید.

**فصل ۱۲، استفاده از ابزارها برای بهبود کیفیت کد (Using Tools to Improve Code Quality)**، شما را با ابزارهای مختلفی آشنا می‌کند که به شما در نوشتن کد با کیفیت و بهبود کیفیت کد موجود کمک خواهند کرد. با **معیارهای کد (Code Metrics)** و **تحلیل کد (Code Analysis)**، **اکشن‌های سریع (Quick Actions)**، ابزارهای **JetBrains** به نام **dotTrace Profiler** و **Resharper**، و **Telerik JustDecompile** آشنا خواهید شد.

**فصل ۱۳، Refactoring کد سی‌شارپ - شناسایی Code Smells (Refactoring C# Code – Identifying Code Smells)**، اولین فصل از دو فصلی است که شما را با انواع مختلف کدهای مشکل‌ساز آشنا کرده و نشان می‌دهد که چگونه آن‌ها را تغییر دهید تا به کد تمیزی تبدیل شوند که خواندن، نگهداری و توسعه آن آسان است. مشکلات کد به صورت الفبایی در هر فصل فهرست شده‌اند. در این فصل، مباحثی مانند وابستگی‌های کلاس (Class Dependencies)، کدی که قابل تغییر نیست، Collectionها و **انفجار ترکیبیاتی (Combinatorial Explosion)** را پوشش خواهید داد.

**فصل ۱۴، Refactoring کد سی‌شارپ - پیاده‌سازی الگوهای طراحی (Refactoring C# Code – Implementing Design Patterns)**، شما را از طریق پیاده‌سازی الگوهای طراحی **خلقی (Creational)** و **ساختاری (Structural)** راهنمایی می‌کند. در اینجا، به طور مختصر به الگوهای طراحی **رفتاری (Behavioral Design Patterns)** نیز اشاره می‌شود. شما سپس چند نکته پایانی در مورد کد تمیز و **Refactoring** دریافت می‌کنید.

## برای حداکثر بهره‌برداری از این کتاب

اکثر فصل‌ها را می‌توان مستقل از یکدیگر و به هر ترتیبی مطالعه کرد. اما برای بهره‌برداری حداکثری از این کتاب، توصیه می‌کنم فصل‌ها را به ترتیب ارائه شده مطالعه کنید. در حین کار با فصل‌ها، دستورالعمل‌ها را دنبال کرده و وظایف ارائه شده را انجام دهید. سپس، در پایان هر فصل، به سؤالات پاسخ دهید و مطالعه بیشتر توصیه شده را برای تقویت آنچه آموخته‌اید انجام دهید. برای حداکثر بهره‌وری هنگام کار با محتوای این کتاب، توصیه می‌شود شرایط زیر را رعایت کنید:

| نرم‌افزار/سخت‌افزار پوشش داده شده در کتاب | نیازمندی‌ها |
| :-------------------------------------- | :----------- |
| Visual Studio 2019                      | Windows 10, macOS |
| Atom                                    | Windows 10, macOS, Linux: [https://atom.io/](https://atom.io/) |
| Azure resources                         | Azure subscription: [https://azure.microsoft.com/en-gb/](https://azure.microsoft.com/en-gb/) |
| Azure Key Vault                         | Azure subscription: [https://azure.microsoft.com/en-gb/](https://azure.microsoft.com/en-gb/) |
| The Morningstar API                     | Obtain your own API key from [https://rapidapi.com/integraatio/api/morningstar1](https://rapidapi.com/integraatio/api/morningstar1) |
| Postman                                 | Windows 10, macOS, Linux: [https://www.postman.com/](https://www.postman.com/) |

داشتن این موارد قبل از شروع مطالعه و کار با فصل‌ها مفید خواهد بود.

اگر از نسخه دیجیتال این کتاب استفاده می‌کنید، توصیه می‌کنیم کدها را خودتان تایپ کنید یا از طریق مخزن گیت‌هاب (لینک در بخش بعدی موجود است) به کدها دسترسی پیدا کنید. انجام این کار به شما کمک می‌کند تا از هرگونه خطای احتمالی مربوط به کپی و پیست کردن کد جلوگیری کنید. شما باید تجربه اولیه در استفاده از Visual Studio 2019 Community Edition یا بالاتر، و مهارت‌های برنامه‌نویسی پایه C#، از جمله نوشتن برنامه‌های کنسولی را داشته باشید. بسیاری از مثال‌ها به صورت برنامه‌های کنسولی C# خواهند بود. پروژه اصلی از ASP.NET استفاده خواهد کرد. اگر قادر به نوشتن وب‌سایت‌های ASP.NET با استفاده از Framework و Core باشید، کمک‌کننده خواهد بود. اما نگران نباشید – شما در مراحل لازم راهنمایی خواهید شد.
